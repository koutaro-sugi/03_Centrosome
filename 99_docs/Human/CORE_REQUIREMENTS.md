# Centrosome - UAV統合監視システム コア機能要件定義

**プロジェクト名:** Centrosome UAV Monitor  
**プロジェクト番号:** 03_Centrosome  
**ベースプロジェクト:** 01_A1-Console (AirWings UAV Monitor V2)

## 1. プロジェクト概要

Centrosomeは、ドローン/UAVの統合監視システムとして、映像配信、テレメトリデータ表示、ジンバル制御を統合したWebベースのコンソールアプリケーションです。既存のA1-Consoleプロジェクトを最新の技術スタックで再構築し、保守性・拡張性・パフォーマンスを大幅に向上させた次世代プラットフォームを提供します。

## 2. プロジェクト目標

### 2.1 技術的目標
- **技術的負債の解消**: レガシーJavaScriptを廃し、React + TypeScript統一
- **保守性向上**: テストコード・静的解析ツール導入によるコード品質担保
- **UX向上**: Material-UIによる統一されたデザインシステム
- **セキュリティ強化**: AWS Cognitoによる標準化された認証フロー
- **機能統合**: MAVLinkテレメトリのWebコンソール統合表示

### 2.2 システム統合目標
- **エッジコンピューティング**: Raspberry Pi 5による現場処理
- **クラウド連携**: AWS KVS/Cognitoとのシームレス統合
- **リアルタイム性**: 低遅延映像配信（目標500ms以下）

## 3. システム構成

### 3.1 アーキテクチャ概要
```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   UAV/Drone     │───▶│ Raspberry Pi 5   │───▶│  AWS Cloud      │
│ - カメラ        │    │ - エッジ処理     │    │ - KVS WebRTC    │
│ - MAVLink       │    │ - 映像配信       │    │ - Cognito Auth  │
│ - ジンバル      │    │ - テレメトリ転送 │    │ - Amplify Gen2  │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                                         │
                                                         ▼
                                               ┌─────────────────┐
                                               │ Centrosome      │
                                               │ Web Console     │
                                               │ - React/TS      │
                                               │ - Material-UI   │
                                               │ - Grid Layout   │
                                               └─────────────────┘
```

### 3.2 コンポーネント構成
- **console/**: Webコンソールアプリケーション（旧minimal-viewer）
- **simulator/**: ジンバルシミュレーター（開発・テスト用）
- **edge/**: Raspberry Pi関連スクリプト・設定
- **docs/**: プロジェクト文書・設定ガイド

## 4. 機能要件

### 4.1 認証機能
| ID | 機能 | 詳細 |
|---|---|---|
| **FR-AUTH-01** | ユーザー認証 | Cognitoによるメール・パスワード認証 |
| **FR-AUTH-02** | セッション管理 | ログイン状態のセッション間維持 |
| **FR-AUTH-03** | アクセス制御 | 未認証ユーザーの自動リダイレクト |

### 4.2 ダッシュボード機能
| ID | 機能 | 詳細 |
|---|---|---|
| **FR-DASH-01** | グリッドレイアウト | ウィジェットのグリッドベース配置 |
| **FR-DASH-02** | レイアウト編集 | ドラッグ&ドロップ・リサイズ対応 |
| **FR-DASH-03** | レイアウト保存 | ユーザー固有レイアウトの永続化 |

### 4.3 映像配信機能
| ID | 機能 | 詳細 |
|---|---|---|
| **FR-VID-01** | リアルタイム映像表示 | KVS WebRTCによる低遅延配信（目標500ms以下） |
| **FR-VID-02** | マルチカメラ対応 | FPV・ペイロードカメラの同時表示 |
| **FR-VID-03** | 接続制御 | 個別ウィジェットでの接続・切断制御 |

### 4.4 テレメトリ・制御機能
| ID | 機能 | 詳細 |
|---|---|---|
| **FR-MAV-01** | テレメトリ表示 | 姿勢・高度・速度・GPS情報のリアルタイム表示 |
| **FR-MAV-02** | ジンバル制御 | パン・チルト角度操作UI |

## 5. 非機能要件

| カテゴリ | 要件 | 詳細 |
|---|---|---|
| **パフォーマンス** | NFR-PERF-01 | ページロード3秒以内、映像遅延500ms未満 |
| **ユーザビリティ** | NFR-USE-01 | Material-UI準拠の直感的UI |
| **セキュリティ** | NFR-SEC-01 | AWSベストプラクティス準拠、認証情報ハードコード禁止 |
| **保守性** | NFR-MAIN-01 | TypeScript統一、ESLint・Prettier強制 |
| **テスト容易性** | NFR-TEST-01 | Jest・React Testing Library、カバレッジ70%以上 |
| **互換性** | NFR-COMP-01 | 主要ブラウザ対応（Chrome・Firefox・Safari・Edge） |
| **CI/CD** | NFR-DEVOPS-01 | mainブランチマージ時の自動テスト・ビルド・デプロイ |

## 6. 技術スタック

### 6.1 フロントエンド
- **React** 18+ with TypeScript 5+
- **Vite** 5+ (ビルドツール)
- **Material-UI** (UIフレームワーク)
- **Zustand** (状態管理)
- **react-grid-layout** (ダッシュボードレイアウト)

### 6.2 バックエンド・インフラ
- **AWS Amplify Gen2** (サーバーレスバックエンド)
- **Amazon Cognito** (認証)
- **Amazon Kinesis Video Streams** (WebRTC映像配信)

### 6.3 開発・運用
- **Jest** + **React Testing Library** (テスト)
- **ESLint** + **Prettier** (静的解析・フォーマット)
- **GitHub Actions** (CI/CD)

### 6.4 エッジ・デバイス
- **Raspberry Pi 5** (エッジコンピューティング)
- **MAVLink** (テレメトリ通信)
- **GStreamer** (映像パイプライン)

## 7. スコープ

### 7.1 スコープ内
✅ Cognitoベース認証システム  
✅ ドラッグ&ドロップダッシュボード  
✅ KVS WebRTCマルチカメラ配信  
✅ MAVLinkテレメトリ統合表示  
✅ ジンバル制御UI  
✅ AWS Amplify Gen2バックエンド  
✅ CI/CDパイプライン構築  

### 7.2 スコープ外
❌ ドローン直接操縦機能  
❌ 詳細飛行ログ解析  
❌ モバイルアプリ開発  
❌ Raspberry Pi新規ソフト開発  

## 8. 成果物

1. **ソースコード一式** (GitHubリポジトリ)
2. **技術文書** (README・アーキテクチャ・開発手順)
3. **デプロイ済みWebアプリケーション** (AWS Amplify)
4. **CI/CDワークフロー** (GitHub Actions)

## 9. 前提条件・制約事項

- AWSアカウント・必要サービス利用可能
- Raspberry Pi側`Raspi-Persona`正常動作
- 開発は`03_Centrosome`内で実施
- 既存A1-Consoleからの段階的移行

## 10. プロジェクト移行計画

### Phase 1: 基盤構築
- プロジェクト構造確立
- 既存コードの選別・移行
- 基本CI/CD設定

### Phase 2: コア機能実装
- 認証システム統合
- ダッシュボード基盤
- 映像配信機能

### Phase 3: 統合・最適化
- MAVLinkテレメトリ統合
- パフォーマンス最適化
- テスト充実

### Phase 4: 運用準備
- 本番デプロイ
- 監視・ログ設定
- 文書整備

---

**更新履歴:**
- 2025-06-30: A1-Console要件定義をベースにCentrosome用に統合・更新